CREATE TABLE [dbo].[USER_DETAILS]
(
    [USER_DETAIL_ID] [BIGINT] IDENTITY(1, 1),
	[ROLE_ID] [BIGINT] NOT NULL,
    [USERNAME] [NVARCHAR](128) NOT NULL,
	[TITLE] [NVARCHAR](32) NULL,
	[FIRST_NAME] [NVARCHAR](256) NOT NULL,
	[MIDDLE_NAME] [NVARCHAR](256) NULL,
	[LAST_NAME] [NVARCHAR](256) NULL,
    [PRIMARY_EMAIL] [NVARCHAR](256) NOT NULL,
	[ALTERNATE_EMAIL] [NVARCHAR](256) NULL,
	[PRIMARY_PHONE] [NVARCHAR](256) NOT NULL,
    [ALTERNATE_PHONE] [NVARCHAR](256) NULL,
	[IS_ACTIVE] [BIT] NULL CONSTRAINT [DF_USER_DETAILS_IS_ACTIVE] DEFAULT ((1)),
	[CREATED_BY] [BIGINT] NULL,
	[CREATED_ON] [DATETIME] NULL,
	[UPDATED_BY] [BIGINT] NULL,
	[UPDATED_ON] [DATETIME] NULL,
	[DELETED_BY] [BIGINT] NULL,
	[DELETED_ON] [DATETIME] NULL,
	[ROW_VERSION] [ROWVERSION] NOT NULL
)
ALTER TABLE [dbo].[USER_DETAILS] ADD CONSTRAINT [PK_USER_DETAILS_USER_DETAIL_ID] PRIMARY KEY CLUSTERED  ([USER_DETAIL_ID]) WITH (FILLFACTOR=80) ON [PRIMARY]
GO
ALTER TABLE [dbo].[USER_DETAILS] ADD CONSTRAINT [UX_USER_DETAILS_USERNAME] UNIQUE ([USERNAME])
GO
ALTER TABLE [dbo].[USER_DETAILS] ADD CONSTRAINT [FK_USER_DETAILS_ROLE_ID] FOREIGN KEY ([ROLE_ID]) REFERENCES [dbo].[ROLE] ([ROLE_ID]) NOT FOR REPLICATION
GO

CREATE TABLE [dbo].[USER_LOGIN_DETAILS]
(
[USER_LOGIN_DETAIL_ID] BIGINT IDENTITY(1, 1),
[USER_DETAIL_ID] BIGINT NOT NULL,
[PASSWORD] [NVARCHAR] (128) NOT NULL, 
[PASSWORDSALT] [NVARCHAR] (128) NULL,
[PASSWORDQUESTION] [NVARCHAR] (512) NULL,
[PASSWORDANSWER] [NVARCHAR] (256) NULL,
[ISLOCKEDOUT] [BIT] NOT NULL CONSTRAINT [DF_USER_LOGIN_DETAILS_ISLOCKEDOUT] DEFAULT ((0)),
[LASTLOGINDATE] [DATETIME] NULL,
[LASTPASSWORDCHANGEDDATE] [DATETIME] NULL,
[LASTLOCKOUTDATE] [DATETIME] NULL,
[FAILEDPASSWORDATTEMPTCOUNT] [INT] NOT NULL,
[FAILEDPASSWORDANSWERATTEMPTCOUNT] [INT] NOT NULL,
[CREATED_BY] [BIGINT] NULL,
[CREATED_ON] [DATETIME] NULL,
[UPDATED_BY] [BIGINT] NULL,
[UPDATED_ON] [DATETIME] NULL,
[DELETED_BY] [BIGINT] NULL,
[DELETED_ON] [DATETIME] NULL,
[ROW_VERSION] [ROWVERSION] NOT NULL
)
ALTER TABLE [dbo].[USER_LOGIN_DETAILS] ADD CONSTRAINT [PK_USER_LOGIN_DETAILS_USER_LOGIN_DETAIL_ID] PRIMARY KEY CLUSTERED  ([USER_LOGIN_DETAIL_ID]) WITH (FILLFACTOR=80) ON [PRIMARY]
GO
ALTER TABLE [dbo].[USER_LOGIN_DETAILS] ADD CONSTRAINT [FK_USER_LOGIN_DETAILS_USER_DETAIL_ID] FOREIGN KEY ([USER_DETAIL_ID]) REFERENCES [dbo].[USER_DETAILS] ([USER_DETAIL_ID]) NOT FOR REPLICATION
GO
-- pass worng time and count need to reset after 24h